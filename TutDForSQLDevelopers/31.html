<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
  </head>
<body>
<!-- template_tutd_sql.html -->
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/default.min.css">
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script>
<link href="style.css" rel="stylesheet"/>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
  document.querySelectorAll('code').forEach((el) => {
    hljs.highlightElement(el);
  });
});
document.addEventListener('keyup',(e)=>{
if(e.keyCode == 39)
{
  if(32)
  document.location='32.html';
}
if(e.keyCode == 37) {
  if(30)
  document.location='30.html';
}
});
</script>
<h1>Prelude to Aggregate Functions</h1>
<table border="0" width="97%">
<tr>
<th width="50%">TutorialD</th>
<th width="50%">SQL</th>
</tr>
<tr>
<td>
<pre><code class="language-sql">TutorialD (master/main): :showexpr s group ({all but city} as subrel)</code></pre>
<pre>
┌──────────┬───────────────────────────────────────────────────────┐
│city::Text│subrel::relation {s#::Text,sname::Text,status::Integer}│
├──────────┼───────────────────────────────────────────────────────┤
│"Paris"   │┌────────┬───────────┬───────────────┐                 │
│          ││s#::Text│sname::Text│status::Integer│                 │
│          │├────────┼───────────┼───────────────┤                 │
│          ││"S2"    │"Jones"    │10             │                 │
│          ││"S3"    │"Blake"    │30             │                 │
│          │└────────┴───────────┴───────────────┘                 │
│"Athens"  │┌────────┬───────────┬───────────────┐                 │
│          ││s#::Text│sname::Text│status::Integer│                 │
│          │├────────┼───────────┼───────────────┤                 │
│          ││"S5"    │"Adams"    │30             │                 │
│          │└────────┴───────────┴───────────────┘                 │
│"London"  │┌────────┬───────────┬───────────────┐                 │
│          ││s#::Text│sname::Text│status::Integer│                 │
│          │├────────┼───────────┼───────────────┤                 │
│          ││"S1"    │"Smith"    │20             │                 │
│          ││"S4"    │"Clark"    │20             │                 │
│          │└────────┴───────────┴───────────────┘                 │
└──────────┴───────────────────────────────────────────────────────┘
</pre>
</td>
<td>
<pre><code class="language-sql"># SELECT city,array_agg(ROW("s#",sname,status)) FROM s GROUP BY city; -- a poor approximation of a table within a table</code></pre>
<pre>
  city  |             array_agg             
--------+-----------------------------------
 Paris  | {"(S3,Blake,30)","(S2,Jones,10)"}
 London | {"(S1,Smith,20)","(S4,Clark,20)"}
 Athens | {"(S5,Adams,30)"}
(3 rows)
</pre>
</td>
</tr>
</table>
<h4>
Show me supplier data grouped by city. Relation-valued attributes are not supported in SQL so we use arrays as a workaround.
</h4>
</body>
</html>

